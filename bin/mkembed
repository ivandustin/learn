#!/usr/bin/env python
from pathlib import Path
from time import time
from pickle import dump
from flax.nnx import Rngs, Embed
factors = Path("factors.txt")
factors = factors.read_text().split(" ")
factors = list(map(int, factors))
dims = int(Path("dims.txt").read_text())
seed = int(time())
rngs = Rngs(seed)
embeds = [
    Embed(n, dims, rngs=rngs)
    for n in factors
]
with open("embed.pickle", "wb") as file:
    dump(embeds, file)
